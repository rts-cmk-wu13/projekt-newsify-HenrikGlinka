import{i as g,c as h}from"./settings-manager-C5GFsIZX.js";import{S as f,L as m,l as w,B as S,a,s as y,p as I,b as A,h as E,N as L,c as v}from"./settings-DgGBbcNq.js";const C="https://api.nytimes.com/svc/",D="D8ZjPin6XGFy4rHAEpFEA4ftn16KGFyl",N=1e3*60*5,s=JSON.parse(localStorage.getItem("cache"))??{};async function x(){const e=new URL("topstories/v2/home.json",C);return B(e)}async function B(e,o=N){if(e.searchParams.append("api-key",D),s[e.href]!==void 0&&s[e.href].expiresAt>Date.now()){const p=Math.round((s[e.href].expiresAt-Date.now())/1e3);return console.log(`Returning cached data. Expires in ${p} seconds`),s[e.href].results}console.log("Fetching new data...");const t=await(await fetch(e)).json();return t.expiresAt=Date.now()+o,s[e.href]=t,localStorage.setItem("cache",JSON.stringify(s)),t.results}localStorage.getItem("skipOnboarding")!=="true"&&(location.href="./onboarding/");g();const M=document.querySelector("#app"),c=document.createElement("div"),i=(await x()).filter(e=>!h(e.section));console.log(i);const d=f();M.append(m("Newsify",w,d),c,S(a("Home","/",E,!0),a("Archive","archive/",A),a("Popular","popular/",I),a("Settings","settings/",y)));d.addEventListener("input",e=>{const o=e.target.value.toLowerCase(),n=i.filter(t=>t.section.toLowerCase().includes(o)||t.title.toLowerCase().includes(o)||t.abstract.toLowerCase().includes(o));l(n)});function l(e){c.innerHTML="";const o=e.map(t=>t.section),n=[...new Set(o)].sort();n.length>0&&n.forEach(t=>{const u=e.filter(r=>r.section===t).map(r=>L(r));c.append(v(t,u))})}l(i);
