import"./swiper-DwgOvvCg.js";import{S as m,L as p,l as g,B as u,a as o,s as w,p as S,b as y,h as I,N as v,c as b}from"./settings-HnC-Gk2a.js";const A="https://api.nytimes.com/svc/",E="D8ZjPin6XGFy4rHAEpFEA4ftn16KGFyl",L=1e3*60*5,t=JSON.parse(localStorage.getItem("cache"))??{};async function C(){const e=new URL("topstories/v2/home.json",A);return N(e)}async function N(e,a=L){if(e.searchParams.append("api-key",E),t[e.href]!==void 0&&t[e.href].expiresAt>Date.now()){const c=Math.round((t[e.href].expiresAt-Date.now())/1e3);return console.log(`Returning cached data. Expires in ${c} seconds`),t[e.href].results}console.log("Fetching new data...");const n=await(await fetch(e)).json();return n.expiresAt=Date.now()+a,t[e.href]=n,localStorage.setItem("cache",JSON.stringify(t)),n.results}const x=()=>JSON.parse(localStorage.getItem("settings"))??{categories:[{name:"arts",hidden:!1},{name:"automobiles",hidden:!1},{name:"books",hidden:!1},{name:"briefing",hidden:!1},{name:"business",hidden:!1},{name:"dining",hidden:!1},{name:"fashion",hidden:!1},{name:"food",hidden:!1},{name:"health",hidden:!1},{name:"home",hidden:!1},{name:"insider",hidden:!1},{name:"magazine",hidden:!1},{name:"movies",hidden:!1},{name:"nyregion",hidden:!1},{name:"obituaries",hidden:!1},{name:"opinion",hidden:!1},{name:"podcasts",hidden:!1},{name:"politics",hidden:!1},{name:"realestate",hidden:!1},{name:"science",hidden:!1},{name:"sports",hidden:!1},{name:"sundayreview",hidden:!1},{name:"technology",hidden:!1},{name:"theater",hidden:!1},{name:"t-magazine",hidden:!1},{name:"travel",hidden:!1},{name:"upshot",hidden:!1},{name:"us",hidden:!1},{name:"well",hidden:!1},{name:"world",hidden:!1}]},D=e=>{const a=x();return a?.categories===void 0?!1:a.categories.find(s=>s.name===e)?.hidden??!1};localStorage.getItem("skipOnboarding")!=="true"&&(location.href="./onboarding/");const B=document.querySelector("#app"),d=document.createElement("div"),r=(await C()).filter(e=>!D(e.section));console.log(r);const l=m();B.append(p("Newsify",g,l),d,u(o("Home","/",I,!0),o("Archive","archive/",y),o("Popular","popular/",S),o("Settings","settings/",w)));l.addEventListener("input",e=>{const a=e.target.value.toLowerCase(),s=r.filter(n=>n.section.toLowerCase().includes(a)||n.title.toLowerCase().includes(a)||n.abstract.toLowerCase().includes(a));h(s)});function h(e){d.innerHTML="";const a=e.map(n=>n.section),s=[...new Set(a)].sort();s.length>0&&s.forEach(n=>{const f=e.filter(i=>i.section===n).map(i=>v(i));d.append(b(n,f))})}h(r);
